"use strict";window.panoromEditor=function(window,document,undefined){var output={},pnrmEditorDiv=document.querySelector(".pnrm-editor");if(pnrmEditorDiv){console.log("panorom editor page running");var boxMainInterface=document.querySelector(".pnrm-editor .box-main-interface"),mainInterface=document.querySelector(".pnrm-editor .main-interface"),selectTour=document.querySelector(".pnrm-editor #select-tour"),inputShortcode=document.querySelector(".pnrm-editor #input-shortcode"),btnSave=document.querySelector(".pnrm-editor .btn-save"),divNonce=document.querySelector(".pnrm-editor #div-pnrm-nonce"),modalBackground=document.querySelector(".pnrm-editor .modal-background"),isActivated,mainPano=null,mainConfig={},isMainConfigLoaded=!1,isUnsavedChange=!1,tBar;pnrmEditorDiv.addEventListener("click",(function(){hideAllModals()})),btnSave.onclick=function(){isUnsavedChange&&saveConfig()},document.addEventListener("DOMContentLoaded",(function(){var inputIsActivated=document.querySelector(".pnrm-editor #input-is-activated");isActivated="true"===inputIsActivated.value;var urlParams,tourId=new URLSearchParams(window.location.search).get("tour_id");tourId&&(selectTour.value=tourId,currentTourId=tourId,window.history.replaceState({},document.title,"?page=panorom-editor")),tBar=new PnrmTumbnailBar({topContainer:boxMainInterface,isActivated:isActivated,isEditorPage:!0}),loadConfig()})),window.addEventListener("beforeunload",(function(e){if(isUnsavedChange)return e.preventDefault(),e.returnValue="",""}));var modalAjax=document.querySelector(".pnrm-editor .modal-ajax-message"),modalAjaxCloseIcon=document.querySelector(".pnrm-editor .modal-ajax-message .title-bar .close-icon"),modalAjaxErrorMsg=document.querySelector(".pnrm-editor .modal-ajax-message .error-msg");modalAjax.onclick=function(e){e.stopPropagation()},modalAjaxCloseIcon.onclick=function(){closeModalAjax()};var modalTopRightClick=document.querySelector(".pnrm-editor .modal-top-right-click"),modalTopRightClickItemsAll=document.querySelectorAll(".pnrm-editor .modal-top-right-click li");output.rightClickTop=function(event){event.preventDefault();var coords=mainPano.mouseEventToCoords(event),clickPitch=coords[0],clickYaw=coords[1],pointerX,pointerY;hideAllModals(),showModalTopRightClick(event.pageX-pnrmEditorDiv.getBoundingClientRect().left,event.pageY-(pnrmEditorDiv.getBoundingClientRect().top+window.scrollY),clickPitch,clickYaw)},modalTopRightClickItemsAll.forEach((function(listEl){listEl.onclick=function(e){switch(listEl.dataset.action){case"setSceneDefault":handleSetSceneDefault(),setIsUnsavedChange();break;case"setSceneTitle":e.stopPropagation(),hideModalTopRightClick(),showModalSceneTitle();break;case"addHotspot":isMaxHotspotReached()||(handleAddHotspot("scene"),setIsUnsavedChange());break;case"addInfospot":isMaxInfospotReached()||(handleAddHotspot("info"),setIsUnsavedChange())}}}));var modalBanner=document.querySelector(".pnrm-editor .modal-banner-right-click"),modalBannerItemsAll=document.querySelectorAll(".pnrm-editor .modal-banner-right-click li"),frameMediaChangeImage;modalBanner.onclick=function(e){e.stopPropagation()},modalBannerItemsAll.forEach((function(listEl){listEl.onclick=function(e){switch(listEl.dataset.action){case"changeImage":handleChangeImage(modalBanner.dataset.imgId),hideModalBanner();break;case"editUrl":handleEditUrl(modalBanner.dataset.imgId),hideModalBanner();break;case"setAsFirstScene":handleSetAsFirstScene(modalBanner.dataset.imgId),hideModalBanner(),setIsUnsavedChange()}}}));var infoOverlay=document.querySelector(".info-overlay"),infoOverlayBoxContent=document.querySelector(".info-overlay .box-content"),infoOverlayBtnClose=document.querySelector(".info-overlay .close-icon");infoOverlayBoxContent.onclick=function(e){e.stopPropagation()},infoOverlay.onclick=infoOverlayBtnClose.onclick=function(){infoOverlay.classList.remove("show")};var modalInsertUrl=document.querySelector(".pnrm-editor .modal-insert-url"),modalInsertUrlBtnCancel=document.querySelector(".pnrm-editor .modal-insert-url .btn-cancel"),modalInsertUrlInputUrl=document.querySelector(".pnrm-editor .modal-insert-url #input-insert-url"),modalInsertUrlForm=document.querySelector(".pnrm-editor .modal-insert-url form"),btnInsertUrl;document.querySelector(".pnrm-editor .banner .btn-insert-url").onclick=function(e){e.stopPropagation(),modalInsertUrlInputUrl.value="",modalInsertUrl.classList.add("show")},modalInsertUrl.onclick=function(e){e.stopPropagation()},modalInsertUrlBtnCancel.onclick=function(){hideModalInsertUrl()},modalInsertUrlForm.onsubmit=function(e){e.preventDefault();var insertedUrl=sanitizeURL(modalInsertUrlInputUrl.value,!0);if(""!==insertedUrl){hideModalInsertUrl();var lastSceneId=0;for(let key in mainConfig.scenes){var sceneId=key;Number(sceneId)>lastSceneId&&(lastSceneId=Number(sceneId))}lastSceneId++;var sceneId=String(lastSceneId),sceneConfig={},filename;sceneConfig.panorama=insertedUrl,sceneConfig.thumbnail=insertedUrl,mainPano.addScene(sceneId,sceneConfig),addImageElementToBanner(sceneId,insertedUrl?insertedUrl.substring(insertedUrl.lastIndexOf("/")+1,insertedUrl.length):""),showSceneOnMainDiv(sceneId),void 0!==mainConfig.default.firstScene&&"0"!=mainConfig.default.firstScene||handleSetAsFirstScene(sceneId),setIsUnsavedChange()}};var modalEditUrl=document.querySelector(".pnrm-editor .modal-edit-url"),modalEditUrlBtnCancel=document.querySelector(".pnrm-editor .modal-edit-url .btn-cancel"),modalEditUrlInputUrl=document.querySelector(".pnrm-editor .modal-edit-url #input-edit-url"),modalEditUrlForm;document.querySelector(".pnrm-editor .modal-edit-url form").onsubmit=function(e){e.preventDefault();var editUrl=sanitizeURL(modalEditUrlInputUrl.value,!0);if(""!==editUrl){var sceneId=modalEditUrl.dataset.imgId;if(sceneId){var selectedScene=mainConfig.scenes[sceneId];selectedScene&&(selectedScene.panorama=editUrl,selectedScene.thumbnail=editUrl,bannerUpdateThumbnail(sceneId,selectedScene.panorama,selectedScene.thumbnail),showSceneOnMainDiv(sceneId),setIsUnsavedChange(),hideModalEditUrl())}}},modalEditUrl.onclick=function(e){e.stopPropagation()},modalEditUrlBtnCancel.onclick=function(){hideModalEditUrl()};var previewSmallBox=document.querySelector(".pnrm-editor .default-options .box-preview .preview-small-img"),previewBtnChangeImage=document.querySelector(".pnrm-editor .default-options .box-preview .btn-img-change"),modalPreview=document.querySelector(".pnrm-editor .modal-preview-image"),modalPreviewBtnSelectImage=document.querySelector(".pnrm-editor .modal-preview-image .btn-select-image"),modalPreviewInputImage=document.querySelector(".pnrm-editor .modal-preview-image #input-preview-image"),modalPreviewBoxResultImage=document.querySelector(".pnrm-editor .modal-preview-image .box-preview-result .preview-img"),modalPreviewBtnOk=document.querySelector(".pnrm-editor .modal-preview-image .btn-ok"),modalPreviewBtnCancel=document.querySelector(".pnrm-editor .modal-preview-image .btn-cancel"),timerPreviewInputImage,frameMediaPreviewImage;previewBtnChangeImage.onclick=function(){modalPreview.classList.contains("show")||(modalPreview.style.top=33+window.scrollY+"px",modalPreview.classList.add("show"))},modalPreviewBtnCancel.onclick=function(){modalPreview.classList.remove("show")},modalPreviewInputImage.oninput=function(){clearTimeout(timerPreviewInputImage),timerPreviewInputImage=setTimeout((function(){handlePreviewInputImageChange()}),500)},modalPreviewBtnSelectImage.onclick=function(e){e.preventDefault(),(frameMediaPreviewImage=wp.media({title:"Select/Upload Placeholder Image",button:{text:"Select"},library:{type:["image"]},multiple:!1})).on("select",(function(){var attachment=frameMediaPreviewImage.state().get("selection").first().toJSON();modalPreviewInputImage.value=attachment.url,handlePreviewInputImageChange()})),frameMediaPreviewImage.open()},modalPreviewBtnOk.onclick=function(){isMainConfigLoaded?(""!==modalPreviewInputImage.value?(mainConfig.default.preview=modalPreviewInputImage.value,previewSmallBox.style.backgroundImage="url("+modalPreviewInputImage.value+")"):(delete mainConfig.default.preview,previewSmallBox.removeAttribute("style")),setIsUnsavedChange(),modalPreview.classList.remove("show")):modalPreview.classList.remove("show")};var optionBtnAddLogo=document.querySelector(".pnrm-editor .default-options .btn-add-logo"),modalLogo=document.querySelector(".pnrm-editor .modal-custom-logo"),modalLogoBtnSelectImage=document.querySelector(".pnrm-editor .modal-custom-logo .btn-select-image"),modalLogoInputImage=document.querySelector(".pnrm-editor .modal-custom-logo #input-custom-logo"),modalLogoInputSize=document.querySelector(".pnrm-editor .modal-custom-logo #input-logo-width"),modalLogoRadioSizeAuto=document.querySelector(".pnrm-editor .modal-custom-logo #radio-logo-width-auto"),modalLogoRadioSizeFixed=document.querySelector(".pnrm-editor .modal-custom-logo #radio-logo-width-fixed"),modalLogoInputLink=document.querySelector(".pnrm-editor .modal-custom-logo #input-logo-link"),modalLogoCustomLogo=document.querySelector(".pnrm-editor .modal-custom-logo .custom-logo"),modalLogoCustomLogoImg=document.querySelector(".pnrm-editor .modal-custom-logo .custom-logo img"),modalLogoBtnOk=document.querySelector(".pnrm-editor .modal-custom-logo .btn-ok"),modalLogoBtnCancel=document.querySelector(".pnrm-editor .modal-custom-logo .btn-cancel"),initialLogoWidth=30,initialLogoUrl="",initialLogoLink="",frameMediaLogoImage,timerCustomLogo;optionBtnAddLogo.onclick=function(){isMainConfigLoaded?modalLogo.classList.contains("show")||(modalLogo.style.top=33+window.scrollY+"px",modalLogo.classList.add("show")):modalLogo.classList.remove("show")},modalLogoBtnCancel.onclick=function(){modalLogo.classList.remove("show")},modalLogoRadioSizeAuto.onchange=function(){modalLogoRadioSizeAuto.checked&&(modalLogoInputSize.disabled=!0,modalLogoCustomLogoImg.style.width="initial")},modalLogoRadioSizeFixed.onchange=function(){modalLogoRadioSizeFixed.checked&&(modalLogoInputSize.disabled=!1,modalLogoCustomLogoImg.style.width=Number(modalLogoInputSize.value)+"px")},modalLogoInputSize.onchange=function(){modalLogoCustomLogoImg.style.width=Number(modalLogoInputSize.value)+"px"},modalLogoInputLink.oninput=function(){clearTimeout(timerCustomLogo),timerCustomLogo=setTimeout((function(){modalLogoCustomLogo.href=modalLogoInputLink.value}),500)},modalLogoInputImage.oninput=function(){clearTimeout(timerCustomLogo),timerCustomLogo=setTimeout((function(){0===modalLogoInputImage.value.length?modalLogoCustomLogoImg.src="":modalLogoCustomLogoImg.src=modalLogoInputImage.value}),500)},modalLogoBtnSelectImage.onclick=function(e){e.preventDefault(),(frameMediaLogoImage=wp.media({title:"Select/Upload Placeholder Image",button:{text:"Select"},library:{type:["image"]},multiple:!1})).on("select",(function(){var attachment=frameMediaLogoImage.state().get("selection").first().toJSON();modalLogoInputImage.value=attachment.url,modalLogoCustomLogoImg.src=attachment.url})),frameMediaLogoImage.open()},modalLogoBtnOk.onclick=function(){modalLogoInputImage.value.length>0?mainConfig.default.pnrmLogoUrl=modalLogoInputImage.value:delete mainConfig.default.pnrmLogoUrl,modalLogoRadioSizeFixed.checked?mainConfig.default.pnrmLogoSizeFixed=Number(modalLogoInputSize.value):delete mainConfig.default.pnrmLogoSizeFixed,modalLogoInputLink.value.length>0?mainConfig.default.pnrmLogoLink=modalLogoInputLink.value:delete mainConfig.default.pnrmLogoLink,applyConfigToMainLogo(),resetMainPano(),initMainPano(),setIsUnsavedChange(),modalLogo.classList.remove("show")};var optionBtnCustomizeIcon=document.querySelector(".pnrm-editor .default-options .btn-customize-icon"),modalIcon=document.querySelector(".pnrm-editor .modal-custom-icon"),modalIconInputColor=document.querySelector(".pnrm-editor .modal-custom-icon #input-icon-color"),modalIconInputSize=document.querySelector(".pnrm-editor .modal-custom-icon #input-icon-size"),modalIconInputBackgroundColor=document.querySelector(".pnrm-editor .modal-custom-icon #input-icon-background-color"),modalIconInputBackgroundOpacity=document.querySelector(".pnrm-editor .modal-custom-icon #input-icon-background-opacity"),modalIconInputBackgroundSize=document.querySelector(".pnrm-editor .modal-custom-icon #input-icon-background-size"),modalIconSwitchTooltip=document.querySelector(".pnrm-editor .modal-custom-icon #input-toggle-same-for-tooltip"),modalIconPreviewIcons=document.querySelectorAll(".pnrm-editor .modal-custom-icon .box-preview-result i"),modalIconBtnOk=document.querySelector(".pnrm-editor .modal-custom-icon .btn-ok"),modalIconBtnCancel=document.querySelector(".pnrm-editor .modal-custom-icon .btn-cancel"),initialIconColor="#222222",initialIconSize=15,initialIconBackgroundColor="#ffffff",initialIconBackgroundOpacity=.8,initialIconBackgroundSize=30;optionBtnCustomizeIcon.onclick=function(){isMainConfigLoaded?modalIcon.classList.contains("show")||(modalIcon.style.top=33+window.scrollY+"px",modalIcon.classList.add("show")):hideModalIcon()},modalIconBtnCancel.onclick=function(){hideModalIcon()},modalIconInputColor.oninput=function(){modalIconPreviewIcons.forEach((function(previewIcon){previewIcon.style.color=modalIconInputColor.value}))},modalIconInputSize.oninput=function(){modalIconPreviewIcons.forEach((function(previewIcon){previewIcon.style.fontSize=modalIconInputSize.value+"px"}))},modalIconInputBackgroundColor.oninput=function(){console.log(modalIconInputBackgroundColor.value),modalIconPreviewIcons.forEach((function(previewIcon){var hex=modalIconInputBackgroundColor.value,opacity=modalIconInputBackgroundOpacity.value,rgbObj=hexToRgb(hex);if(rgbObj){var rgba="rgba("+rgbObj.r+","+rgbObj.g+","+rgbObj.b+","+opacity+")";previewIcon.style.backgroundColor=rgba}}))},modalIconInputBackgroundOpacity.oninput=function(){modalIconPreviewIcons.forEach((function(previewIcon){var hex=modalIconInputBackgroundColor.value,opacity=modalIconInputBackgroundOpacity.value,rgbObj=hexToRgb(hex);if(rgbObj){var rgba="rgba("+rgbObj.r+","+rgbObj.g+","+rgbObj.b+","+opacity+")";console.log(rgba),previewIcon.style.backgroundColor=rgba}}))},modalIconInputBackgroundSize.oninput=function(){modalIconPreviewIcons.forEach((function(previewIcon){previewIcon.style.width=modalIconInputBackgroundSize.value+"px",previewIcon.style.height=modalIconInputBackgroundSize.value+"px"}))},modalIconBtnOk.onclick=function(){mainConfig.default.pnrmIconColor=modalIconInputColor.value,mainConfig.default.pnrmIconSize=Number(modalIconInputSize.value),mainConfig.default.pnrmIconBackgroundColor=modalIconInputBackgroundColor.value,mainConfig.default.pnrmIconBackgroundOpacity=Number(modalIconInputBackgroundOpacity.value),mainConfig.default.pnrmIconBackgroundSize=Number(modalIconInputBackgroundSize.value),modalIconSwitchTooltip.checked?mainConfig.default.pnrmIconToTooltip=!0:delete mainConfig.default.pnrmIconToTooltip,resetMainPano(),initMainPano(),setIsUnsavedChange(),hideModalIcon()};var modalPicker=document.querySelector(".pnrm-editor .modal-icon-picker"),modalPickerInputSearch=document.querySelector(".pnrm-editor .modal-icon-picker #input-search-icon-name"),modalPickerIconTermsUrl=document.querySelector(".pnrm-editor .modal-icon-picker #input-url-for-icon-terms").value,modalPickerDivSearchResults=document.querySelector(".pnrm-editor .modal-icon-picker .wrap-search-results"),modalPickerCheckboxAnimation=document.querySelector(".pnrm-editor .modal-icon-picker #input-toggle-icon-animation"),modalPickerIconPreview=document.querySelector(".pnrm-editor .modal-icon-picker .icon-preview"),modalPickerIconBoxAnimate=document.querySelector(".pnrm-editor .modal-icon-picker .pnrm-box-animation"),modalPickerBtnOk=document.querySelector(".pnrm-editor .modal-icon-picker .btn-ok"),modalPickerBtnCancel=document.querySelector(".pnrm-editor .modal-icon-picker .btn-cancel"),modalPickerIsOpenFor=null,iconTermsModalPicker,timerModalPicker,iconName=null,xhrIconMeta;(xhrIconMeta=new XMLHttpRequest).onreadystatechange=function(){if(4==this.readyState&&200==this.status){var responseJson=xhrIconMeta.responseText;iconTermsModalPicker=JSON.parse(responseJson)}},xhrIconMeta.open("GET",modalPickerIconTermsUrl,!0),xhrIconMeta.send(),modalPickerBtnCancel.onclick=function(){hideModalPicker()},modalPickerInputSearch.oninput=function(){clearTimeout(timerModalPicker),timerModalPicker=setTimeout((function(){handleInputIconSearchChange()}),500)},modalPickerDivSearchResults.onclick=function(e){var iconsAll,iconClassName,iconFaArray;e.target.className.includes("each-icon")&&(modalPickerDivSearchResults.querySelectorAll(".each-icon").forEach((function(eachIcon){eachIcon.style.backgroundColor="#fff"})),e.target.style.backgroundColor="#d4f6d2",e.target.className.match(/fa-.*?(\s|$)/g).forEach((function(iconFaName){var iconFaNameNoSpace=iconFaName.replace(/\s/g,"");"fa-solid"!==iconFaNameNoSpace&&(iconName=iconFaNameNoSpace)})),updatePreviewIconWithSelected())},modalPickerCheckboxAnimation.onchange=function(){modalPickerCheckboxAnimation.checked?(modalPickerIconBoxAnimate.style.borderColor=getIconBackgroundRGBA(),modalPickerIconBoxAnimate.classList.add("show")):modalPickerIconBoxAnimate.classList.remove("show")},modalPickerBtnOk.onclick=function(){if(iconName){hideModalPicker();var iconAnime=null;modalPickerCheckboxAnimation.checked&&(iconAnime=!0),"infospot"===modalPickerIsOpenFor&&updateInfoSpotIcon(iconName,iconAnime),"hotspot"===modalPickerIsOpenFor&&updateHotSpotIcon(iconName,iconAnime)}};var modalMaxHotspot=document.querySelector(".pnrm-editor .modal-max-hotspot"),modalMaxHotspotDialogbox=document.querySelector(".pnrm-editor .modal-max-hotspot .dialog-box"),modalMaxHotspotBtnCancel=document.querySelector(".pnrm-editor .modal-max-hotspot .btn-cancel"),modalMaxInfospot=document.querySelector(".pnrm-editor .modal-max-infospot"),modalMaxInfospotDialogbox=document.querySelector(".pnrm-editor .modal-max-infospot .dialog-box"),modalMaxInfospotBtnCancel=document.querySelector(".pnrm-editor .modal-max-infospot .btn-cancel");modalMaxHotspot.onclick=modalMaxHotspotBtnCancel.onclick=function(){modalMaxHotspot.classList.remove("show")},modalMaxInfospot.onclick=modalMaxInfospotBtnCancel.onclick=function(){modalMaxInfospot.classList.remove("show")},modalMaxHotspotDialogbox.onclick=function(e){e.stopPropagation()},modalMaxInfospotDialogbox.onclick=function(e){e.stopPropagation()};var modalSceneTitle=document.querySelector(".pnrm-editor .modal-scene-title"),modalSceneTitleInputTitle=document.querySelector(".pnrm-editor .modal-scene-title #input-scene-title"),modalSceneTitleBtnOk=document.querySelector(".pnrm-editor .modal-scene-title .btn-ok"),modalSceneTitleBtnCancel=document.querySelector(".pnrm-editor .modal-scene-title .btn-cancel");modalSceneTitle.onclick=function(e){e.stopPropagation()},modalSceneTitleBtnCancel.onclick=function(){hideModalSceneTitle()},modalSceneTitleBtnOk.onclick=function(){var scene=mainConfig.scenes[mainPano.getScene()];if(void 0!==scene){""!==modalSceneTitleInputTitle.value?scene.previewTitle=modalSceneTitleInputTitle.value:delete scene.previewTitle,setIsUnsavedChange(),hideModalSceneTitle();var currentPitch=mainPano.getPitch(),currentYaw=mainPano.getYaw(),currentHfov=mainPano.getHfov();mainPano.loadScene(mainPano.getScene(),currentPitch,currentYaw,currentHfov)}else hideModalSceneTitle()};var modalInfoSpot=document.querySelector(".pnrm-editor .modal-infospot-right-click"),modalInfoSpotTextInput=document.querySelector(".pnrm-editor .modal-infospot-right-click #input-infospot-text"),modalInfoSpotRadioAuto=document.querySelector(".pnrm-editor .modal-infospot-right-click #input-infospot-width-auto"),modalInfoSpotRadioFixed=document.querySelector(".pnrm-editor .modal-infospot-right-click #input-infospot-width-fixed"),modalInfoSpotInputWidth=document.querySelector(".pnrm-editor .modal-infospot-right-click #input-infospot-width"),modalInfoSpotBtnSelectImage=document.querySelector(".pnrm-editor .modal-infospot-right-click #btn-infospot-image"),modalInfoSpotInputImage=document.querySelector(".pnrm-editor .modal-infospot-right-click #input-infospot-image"),modalInfoSpotInputVideo=document.querySelector(".pnrm-editor .modal-infospot-right-click #input-infospot-video"),modalInfoSpotBtnSelectVideo=document.querySelector(".pnrm-editor .modal-infospot-right-click #btn-infospot-video"),modalInfoSpotCheckboxAutoplay=document.querySelector(".pnrm-editor .modal-infospot-right-click #input-infospot-autoplay"),modalInfoSpotCheckboxLoop=document.querySelector(".pnrm-editor .modal-infospot-right-click #input-infospot-loop"),modalInfoSpotCheckboxAllowVideo=document.querySelector(".pnrm-editor .modal-infospot-right-click #input-infospot-allow-video"),modalInfoSpotDivVideoRow2=document.querySelector(".pnrm-editor .modal-infospot-right-click .video-row-2"),modalInfoSpotDivVideoRow3=document.querySelector(".pnrm-editor .modal-infospot-right-click .video-row-3"),modalInfoSpotCheckboxAllowLink=document.querySelector(".pnrm-editor .modal-infospot-right-click #input-infospot-allow-link"),modalInfoSpotDivLink=document.querySelector(".pnrm-editor .modal-infospot-right-click .div-link"),modalInfoSpotInputLink=document.querySelector(".pnrm-editor .modal-infospot-right-click #input-infospot-link"),modalInfoSpotRadioHover=document.querySelector(".pnrm-editor .modal-infospot-right-click #input-infospot-show-hover"),modalInfoSpotRadioAlways=document.querySelector(".pnrm-editor .modal-infospot-right-click #input-infospot-show-always"),modalInfoSpotIconDefault=document.querySelector(".pnrm-editor .modal-infospot-right-click .icon-default"),modalInfoSpotIconCustom=document.querySelector(".pnrm-editor .modal-infospot-right-click .icon-custom"),modalInfoSpotIconBtnReset=document.querySelector(".pnrm-editor .modal-infospot-right-click .btn-reset-icon"),modalInfoSpotIconBtnChange=document.querySelector(".pnrm-editor .modal-infospot-right-click .btn-change-icon"),modalInfoSpotRemoveCheckbox=document.querySelector(".pnrm-editor .modal-infospot-right-click #input-infospot-remove"),modalInfoSpotBtnOk=document.querySelector(".pnrm-editor .modal-infospot-right-click .btn-ok"),modalInfoSpotBtnCancel=document.querySelector(".pnrm-editor .modal-infospot-right-click .btn-cancel"),frameMediaInfoSpotImage,frameMediaInfoSpotVideo;modalInfoSpot.onclick=modalInfoSpot.ontouchstart=function(e){e.stopPropagation()},modalInfoSpotBtnCancel.onclick=function(){hideModalInfoSpot()},modalInfoSpotRadioAuto.onchange=function(){modalInfoSpotRadioAuto.checked&&(modalInfoSpotInputWidth.disabled=!0)},modalInfoSpotRadioFixed.onchange=function(){modalInfoSpotRadioFixed.checked&&(modalInfoSpotInputWidth.disabled=!1)},modalInfoSpotBtnSelectImage.onclick=function(e){e.preventDefault(),frameMediaInfoSpotImage?frameMediaInfoSpotImage.open():((frameMediaInfoSpotImage=wp.media({title:"Select/Upload Info Image",button:{text:"Select"},library:{type:["image"]},multiple:!1})).on("select",(function(){var attachment=frameMediaInfoSpotImage.state().get("selection").first().toJSON();modalInfoSpotInputImage.value=attachment.url})),frameMediaInfoSpotImage.open())},modalInfoSpotBtnSelectVideo.onclick=function(e){e.preventDefault(),frameMediaInfoSpotVideo?frameMediaInfoSpotVideo.open():((frameMediaInfoSpotVideo=wp.media({title:"Select/Upload Info Video",button:{text:"Select"},library:{type:["video"]},multiple:!1})).on("select",(function(){var attachment=frameMediaInfoSpotVideo.state().get("selection").first().toJSON();modalInfoSpotInputVideo.value=attachment.url})),frameMediaInfoSpotVideo.open())},modalInfoSpotCheckboxAllowLink.onchange=function(){modalInfoSpotCheckboxAllowLink.checked?(modalInfoSpotDivLink.classList.add("show"),modalInfoSpotInputLink.focus()):modalInfoSpotDivLink.classList.remove("show")},modalInfoSpotCheckboxAllowVideo.onchange=function(){modalInfoSpotCheckboxAllowVideo.checked?(modalInfoSpotDivVideoRow2.classList.add("show"),modalInfoSpotDivVideoRow3.classList.add("show"),modalInfoSpotInputVideo.focus()):(modalInfoSpotDivVideoRow2.classList.remove("show"),modalInfoSpotDivVideoRow3.classList.remove("show"))},modalInfoSpotIconBtnReset.onclick=function(){modalInfoSpotIconCustom.classList.remove("show"),modalInfoSpotIconCustom.removeAttribute("data-icon-name"),modalInfoSpotIconDefault.classList.add("show")},modalInfoSpotIconBtnChange.onclick=function(e){var pointerX,pointerY;e.preventDefault(),e.stopPropagation(),openModalPicker(e.pageX-pnrmEditorDiv.getBoundingClientRect().left,e.pageY-(pnrmEditorDiv.getBoundingClientRect().top+window.scrollY),"infospot")},modalInfoSpotBtnOk.onclick=function(){var hsId=modalInfoSpot.dataset.hsId,scene,hs=mainConfig.scenes[mainPano.getScene()].hotSpots.find((function(hotspot){return hotspot.id==hsId}));hs.text=String(modalInfoSpotTextInput.value),modalInfoSpotRadioFixed.checked?hs.infoWidth=Number(modalInfoSpotInputWidth.value).toFixed():delete hs.infoWidth,modalInfoSpotInputImage.value?hs.infoImage=sanitizeURL(modalInfoSpotInputImage.value,!0):delete hs.infoImage,modalInfoSpotCheckboxAllowVideo.checked&&modalInfoSpotInputVideo.value?hs.infoVideo=sanitizeURL(modalInfoSpotInputVideo.value,!0):delete hs.infoVideo,modalInfoSpotCheckboxAllowVideo.checked&&modalInfoSpotCheckboxAutoplay.checked?hs.infoVideoAutoplay=!0:delete hs.infoVideoAutoplay,modalInfoSpotCheckboxAllowVideo.checked&&modalInfoSpotCheckboxLoop.checked?hs.infoVideoLoop=!0:delete hs.infoVideoLoop,modalInfoSpotCheckboxAllowLink.checked&&modalInfoSpotInputLink.value?hs.infoURL=sanitizeURL(modalInfoSpotInputLink.value,!0):delete hs.infoURL,modalInfoSpotRadioAlways.checked?hs.cssClass="pnrm-hotspot-show-always pnrm-pnlm-hotspot pnrm-pnlm-sprite pnrm-pnlm-info":delete hs.cssClass,modalInfoSpotIconCustom.dataset.iconName?hs.pnrmIconName=modalInfoSpotIconCustom.dataset.iconName:delete hs.pnrmIconName,modalInfoSpotIconCustom.dataset.iconAnimation?hs.pnrmIconAnimation=modalInfoSpotIconCustom.dataset.iconAnimation:delete hs.pnrmIconAnimation,modalInfoSpotRemoveCheckbox.checked&&mainPano.removeHotSpot(hsId),hideModalInfoSpot();var currentPitch=mainPano.getPitch(),currentYaw=mainPano.getYaw(),currentHfov=mainPano.getHfov();mainPano.loadScene(mainPano.getScene(),currentPitch,currentYaw,currentHfov),setIsUnsavedChange()};var modalHotSpot=document.querySelector(".pnrm-editor .modal-hotspot-right-click"),modalHotSpotSceneSelect=document.querySelector(".pnrm-editor .modal-hotspot-right-click #select-hotspot-to-scene"),modalHotSpotTextInput=document.querySelector(".pnrm-editor .modal-hotspot-right-click #input-hotspot-text"),modalHotSpotRadioAuto=document.querySelector(".pnrm-editor .modal-hotspot-right-click #input-hotspot-width-auto"),modalHotSpotRadioFixed=document.querySelector(".pnrm-editor .modal-hotspot-right-click #input-hotspot-width-fixed"),modalHotSpotInputWidth=document.querySelector(".pnrm-editor .modal-hotspot-right-click #input-hotspot-width"),modalHotSpotRadioHover=document.querySelector(".pnrm-editor .modal-hotspot-right-click #input-hotspot-show-hover"),modalHotSpotRadioAlways=document.querySelector(".pnrm-editor .modal-hotspot-right-click #input-hotspot-show-always"),modalHotSpotRadioTargetDefault=document.querySelector(".pnrm-editor .modal-hotspot-right-click #input-hotspot-target-default"),modalHotSpotRadioTargetManual=document.querySelector(".pnrm-editor .modal-hotspot-right-click #input-hotspot-target-manual"),modalHotSpotRadioTargetAuto=document.querySelector(".pnrm-editor .modal-hotspot-right-click #input-hotspot-target-auto"),modalHotSpotRowTargetMode=document.querySelector(".pnrm-editor .modal-hotspot-right-click #row-target-mode"),modalHotSpotRowTargetAdjust=document.querySelector(".pnrm-editor .modal-hotspot-right-click #row-target-adjust"),modalHotSpotTargetInputX=document.querySelector(".pnrm-editor .modal-hotspot-right-click #input-hotspot-target-x"),modalHotSpotTargetInputY=document.querySelector(".pnrm-editor .modal-hotspot-right-click #input-hotspot-target-y"),modalHotSpotBtnTargetClear=document.querySelector(".pnrm-editor .modal-hotspot-right-click .button-hotspot-target-clear"),modalHotSpotBtnTargetSet=document.querySelector(".pnrm-editor .modal-hotspot-right-click .button-hotspot-target-set"),modalHotSpotIconDefault=document.querySelector(".pnrm-editor .modal-hotspot-right-click .icon-default"),modalHotSpotIconCustom=document.querySelector(".pnrm-editor .modal-hotspot-right-click .icon-custom"),modalHotSpotIconBtnReset=document.querySelector(".pnrm-editor .modal-hotspot-right-click .btn-reset-icon"),modalHotSpotIconBtnChange=document.querySelector(".pnrm-editor .modal-hotspot-right-click .btn-change-icon"),modalHotSpotRemoveCheckbox=document.querySelector(".pnrm-editor .modal-hotspot-right-click #input-hotspot-remove"),modalHotSpotBtnOk=document.querySelector(".pnrm-editor .modal-hotspot-right-click .btn-ok"),modalHotSpotBtnCancel=document.querySelector(".pnrm-editor .modal-hotspot-right-click .btn-cancel");modalHotSpot.onclick=modalHotSpot.ontouchstart=function(e){e.stopPropagation()},modalHotSpotRadioAuto.onchange=function(){modalHotSpotRadioAuto.checked&&(modalHotSpotInputWidth.disabled=!0)},modalHotSpotRadioFixed.onchange=function(){modalHotSpotRadioFixed.checked&&(modalHotSpotInputWidth.disabled=!1)},modalHotSpotRadioTargetDefault.onchange=function(){modalHotSpotRadioTargetDefault.checked&&(modalHotSpotTargetInputX.value="",modalHotSpotTargetInputY.value="",hideAuxInterface(),hideHotSpotRowTargetAdjust())},modalHotSpotRadioTargetAuto.onchange=function(){modalHotSpotRadioTargetAuto.checked&&(modalHotSpotTargetInputX.value="",modalHotSpotTargetInputY.value="",hideAuxInterface(),hideHotSpotRowTargetAdjust())},modalHotSpotRadioTargetManual.onchange=function(){modalHotSpotRadioTargetManual.checked&&showHotSpotRowTargetAdjust()},modalHotSpotBtnTargetSet.onclick=function(e){var pointerX,pointerY;showAuxInterface(e.pageX-pnrmEditorDiv.getBoundingClientRect().left,e.pageY-(pnrmEditorDiv.getBoundingClientRect().top+window.scrollY),mainConfig.scenes[modalHotSpotSceneSelect.value].panorama,modalHotSpotTargetInputX.value,modalHotSpotTargetInputY.value)},modalHotSpotBtnTargetClear.onclick=function(){modalHotSpotTargetInputX.value="",modalHotSpotTargetInputY.value=""},modalHotSpotBtnCancel.onclick=function(){hideModalHotSpot()},modalHotSpotIconBtnReset.onclick=function(){modalHotSpotIconCustom.classList.remove("show"),modalHotSpotIconCustom.removeAttribute("data-icon-name"),modalHotSpotIconDefault.classList.add("show")},modalHotSpotIconBtnChange.onclick=function(e){var pointerX,pointerY;e.preventDefault(),e.stopPropagation(),openModalPicker(e.pageX-pnrmEditorDiv.getBoundingClientRect().left,e.pageY-(pnrmEditorDiv.getBoundingClientRect().top+window.scrollY),"hotspot")},modalHotSpotBtnOk.onclick=function(){setAndCloseAuxInterface();var hsId=modalHotSpot.dataset.hsId,scene,hs=mainConfig.scenes[mainPano.getScene()].hotSpots.find((function(hotspot){return hotspot.id==hsId}));hs.sceneId=modalHotSpotSceneSelect.value,hs.text=modalHotSpotTextInput.value,modalHotSpotRadioFixed.checked?hs.hotWidth=Number(modalHotSpotInputWidth.value).toFixed():delete hs.hotWidth,modalHotSpotRadioAlways.checked?hs.cssClass="pnrm-hotspot-show-always pnrm-pnlm-hotspot pnrm-pnlm-sprite pnrm-pnlm-scene":delete hs.cssClass,modalHotSpotRadioTargetAuto.checked?(hs.targetYaw="sameAzimuth",hs.targetPitch="same"):""!==modalHotSpotTargetInputX.value&&""!==modalHotSpotTargetInputY.value?(hs.targetYaw=Number(modalHotSpotTargetInputX.value),hs.targetPitch=Number(modalHotSpotTargetInputY.value)):(delete hs.targetYaw,delete hs.targetPitch),modalHotSpotIconCustom.dataset.iconName?hs.pnrmIconName=modalHotSpotIconCustom.dataset.iconName:delete hs.pnrmIconName,modalHotSpotIconCustom.dataset.iconAnimation?hs.pnrmIconAnimation=modalHotSpotIconCustom.dataset.iconAnimation:delete hs.pnrmIconAnimation,modalHotSpotRemoveCheckbox.checked&&mainPano.removeHotSpot(hsId),hideModalHotSpot();var currentPitch=mainPano.getPitch(),currentYaw=mainPano.getYaw(),currentHfov=mainPano.getHfov();mainPano.loadScene(mainPano.getScene(),currentPitch,currentYaw,currentHfov),setIsUnsavedChange()};var spanCopyShortcode=document.querySelector(".pnrm-editor #copy-shortcode"),divShortcodeCopied=document.querySelector(".pnrm-editor .div-copied"),inputShortcode=document.querySelector(".pnrm-editor #input-shortcode"),spanSizeDesktop=document.querySelector(".pnrm-editor #size-desktop"),spanSizeLaptop=document.querySelector(".pnrm-editor #size-laptop"),spanSizeMobile=document.querySelector(".pnrm-editor #size-mobile"),modalChangeTour=document.querySelector(".pnrm-editor .modal-change-tour"),modalChangeTourCloseIcon=document.querySelector(".pnrm-editor .modal-change-tour .title-bar .close-icon"),modalChangeTourBtnOk=document.querySelector(".pnrm-editor .modal-change-tour .btn-ok"),modalChangeTourBtnCancel=document.querySelector(".pnrm-editor .modal-change-tour .btn-cancel"),currentTourId=selectTour.value;selectTour.onchange=function(e){isUnsavedChange?showModalChangeTour():changeTheTour()},modalChangeTourBtnCancel.onclick=modalChangeTourCloseIcon.onclick=function(){hideModalChangeTour(),selectTour.value=currentTourId},modalChangeTourBtnOk.onclick=function(){hideModalChangeTour(),changeTheTour()},spanCopyShortcode.onclick=function(e){var text=inputShortcode.value;navigator.clipboard.writeText(text).then((function(){divShortcodeCopied.classList.add("show"),setTimeout((function(){divShortcodeCopied.classList.remove("show")}),1e3)}))},spanSizeDesktop.onclick=function(e){boxMainInterface.classList.remove("small-screen"),boxMainInterface.classList.add("large-screen"),spanSizeDesktop.classList.add("selected"),spanSizeLaptop.classList.remove("selected"),spanSizeMobile.classList.remove("selected"),resetMainPano(),calculateHfovFromPnrmHfov(),calculateHeightForScreenSizes(),initMainPano()},spanSizeLaptop.onclick=function(e){boxMainInterface.classList.remove("small-screen"),boxMainInterface.classList.remove("large-screen"),spanSizeDesktop.classList.remove("selected"),spanSizeLaptop.classList.add("selected"),spanSizeMobile.classList.remove("selected"),resetMainPano(),calculateHfovFromPnrmHfov(),calculateHeightForScreenSizes(),initMainPano()},spanSizeMobile.onclick=function(e){boxMainInterface.classList.remove("large-screen"),boxMainInterface.classList.add("small-screen"),spanSizeDesktop.classList.remove("selected"),spanSizeLaptop.classList.remove("selected"),spanSizeMobile.classList.add("selected"),resetMainPano(),calculateHfovFromPnrmHfov(),calculateHeightForScreenSizes(),initMainPano()};var btnAddImage=document.querySelector(".pnrm-editor .btn-add-image"),frameMedia,bannerImageContainer=document.querySelector(".pnrm-editor .img-container"),bannerImageContainerBox=document.querySelector(".pnrm-editor .img-container-box"),modalRemoveImage=document.querySelector(".pnrm-editor .modal-remove-image"),modalRemoveImageCancelBtn=document.querySelector(".pnrm-editor .modal-remove-image .btn-cancel"),modalRemoveImageRemoveBtn=document.querySelector(".pnrm-editor .modal-remove-image .btn-ok");!function registerBannerSlider(){const slider=bannerImageContainerBox;let isDown=!1,startX,scrollLeft;slider.addEventListener("mousedown",e=>{isDown=!0,startX=e.pageX-slider.offsetLeft,scrollLeft=slider.scrollLeft}),slider.addEventListener("mouseleave",()=>{isDown=!1}),slider.addEventListener("mouseup",()=>{isDown=!1}),slider.addEventListener("mousemove",e=>{if(!isDown)return;e.preventDefault();const x=e.pageX-slider.offsetLeft,walk=1*(x-startX);slider.scrollLeft=scrollLeft-walk})}(),modalRemoveImageCancelBtn.onclick=function(){hideRemoveImageModal()},modalRemoveImageRemoveBtn.onclick=function(){var sceneId=modalRemoveImage.dataset.imgId;hideRemoveImageModal(),handleImageDelete(sceneId),setIsUnsavedChange()},modalRemoveImage.onclick=function(e){e.stopPropagation()},btnAddImage.onclick=function(e){e.preventDefault(),(frameMedia=wp.media({title:"Select/Upload Your Equirectangular Image",button:{text:"Select"},library:{type:["image"]},multiple:!1})).on("select",(function(){var attachment=frameMedia.state().get("selection").first().toJSON(),lastSceneId=0;for(let key in mainConfig.scenes){var sceneId=key;Number(sceneId)>lastSceneId&&(lastSceneId=Number(sceneId))}lastSceneId++;var sceneId=String(lastSceneId),sceneConfig={},panoramaUrl=void 0!==attachment.originalImageURL?attachment.originalImageURL:attachment.url,panoramaUrlNoHttp=panoramaUrl.replace(/^https?:\/\//,"");sceneConfig.panorama=window.location.protocol+"//"+panoramaUrlNoHttp;var thumbnailUrl=attachment.url;void 0!==attachment.sizes&&void 0!==attachment.sizes.medium&&(thumbnailUrl=attachment.sizes.medium.url);var thumbnailUrlNoHttp=thumbnailUrl.replace(/^https?:\/\//,"");sceneConfig.thumbnail=window.location.protocol+"//"+thumbnailUrlNoHttp,mainPano.addScene(sceneId,sceneConfig);var panoramaText=panoramaUrl,filename;addImageElementToBanner(sceneId,panoramaText?panoramaText.substring(panoramaText.lastIndexOf("/")+1,panoramaText.length):""),showSceneOnMainDiv(sceneId),void 0!==mainConfig.default.firstScene&&"0"!=mainConfig.default.firstScene||handleSetAsFirstScene(sceneId),setIsUnsavedChange()})),frameMedia.open()};var inputHeightSmall=document.querySelector(".pnrm-editor .default-options #input-height-small"),inputHeight=document.querySelector(".pnrm-editor .default-options #input-height-medium"),inputHeightLarge=document.querySelector(".pnrm-editor .default-options #input-height-large"),checkboxThumbnailBar=document.querySelector(".pnrm-editor .default-options #checkbox-thumbnail-bar"),inputSmoothDuration=document.querySelector(".pnrm-editor .default-options #input-smoothtransition-duration"),checkboxCompass=document.querySelector(".pnrm-editor .default-options #checkbox-compass"),checkboxAutoload=document.querySelector(".pnrm-editor .default-options #checkbox-autoload"),checkboxFullscreen=document.querySelector(".pnrm-editor .default-options #checkbox-fullscreen"),inputZoomlevel=document.querySelector(".pnrm-editor .default-options #input-zoomlevel"),checkboxMousezoom=document.querySelector(".pnrm-editor .default-options #checkbox-mousezoom"),inputAutorotateSpeed=document.querySelector(".pnrm-editor .default-options #input-autorotate-speed"),inputAutorotateStopAfter=document.querySelector(".pnrm-editor .default-options #input-autorotate-stop-after"),checkboxAutorotateOnlyFirstScene=document.querySelector(".pnrm-editor .default-options #checkbox-autorotate-only-first-scene"),inputFontsize=document.querySelector(".pnrm-editor .default-options #input-fontsize"),radioFontsizeAuto=document.querySelector(".pnrm-editor .default-options #radio-fontsize-auto"),radioFontsizeFixed=document.querySelector(".pnrm-editor .default-options #radio-fontsize-fixed"),radioFontfamilyDefault=document.querySelector(".pnrm-editor .default-options #radio-fontfamily-default"),radioFontfamilyInherit=document.querySelector(".pnrm-editor .default-options #radio-fontfamily-inherit"),checkboxAudio=document.querySelector(".pnrm-editor .default-options #checkbox-audio"),boxAudioOptions=document.querySelector(".pnrm-editor .default-options #box-audio-options"),btnAudioSelectFile=document.querySelector(".pnrm-editor .default-options #btn-audio-select-file"),spanAudioFileName=document.querySelector(".pnrm-editor .default-options .audio-file-name"),radioAudioStartClick=document.querySelector(".pnrm-editor .default-options #radio-audiostart-click"),radioAudioStartInteraction=document.querySelector(".pnrm-editor .default-options #radio-audiostart-interaction"),frameSelectAudio,audioFileUrl=null,initialHeight=500,initialHeightSmall=400,initialHeightLarge=600,initialFontSize=14,initialHfov=100,timerDelayId,boxTitleAll=document.querySelectorAll(".pnrm-editor .default-options .box-title"),boxOptionAll=document.querySelectorAll(".pnrm-editor .default-options .box-option"),timerOptionsMenu;window.onload=function(){boxOptionAll.forEach((function(boxOption){boxOption.classList.contains("open-on-start")&&boxOption.querySelector(".box-title").click()}))},boxTitleAll.forEach((function(boxTitle){boxTitle.onclick=function(e){var boxOption=boxTitle.parentElement,boxContent=boxOption.querySelector(".box-content"),isOpen;boxOption.classList.contains("is-open")?(clearTimeout(timerOptionsMenu),boxOption.classList.remove("is-open"),boxContent.style.height="0",boxContent.style.overflow="hidden"):(boxOption.classList.add("is-open"),boxContent.style.height=boxContent.scrollHeight+"px",timerOptionsMenu=setTimeout((function(){boxContent.style.overflow="initial"}),500))}})),inputHeight.onchange=function(){isMainConfigLoaded&&(mainConfig.default.pnrmHeight=Math.round(inputHeight.value),calculateHeightForScreenSizes(),mainPano.resize(),setIsUnsavedChange(),(boxMainInterface.classList.contains("small-screen")||boxMainInterface.classList.contains("large-screen"))&&spanSizeLaptop.click(),mainConfig.default.pnrmHeight<mainConfig.default.pnrmHeightSmall&&(mainConfig.default.pnrmHeightSmall=mainConfig.default.pnrmHeight,inputHeightSmall.value=mainConfig.default.pnrmHeight),mainConfig.default.pnrmHeight>mainConfig.default.pnrmHeightLarge&&(mainConfig.default.pnrmHeightLarge=mainConfig.default.pnrmHeight,inputHeightLarge.value=mainConfig.default.pnrmHeight))},inputHeightSmall.onchange=function(){isMainConfigLoaded&&(mainConfig.default.pnrmHeightSmall=Math.round(inputHeightSmall.value),calculateHeightForScreenSizes(),mainPano.resize(),setIsUnsavedChange(),boxMainInterface.classList.contains("small-screen")||spanSizeMobile.click(),mainConfig.default.pnrmHeightSmall>mainConfig.default.pnrmHeight&&(mainConfig.default.pnrmHeight=mainConfig.default.pnrmHeightSmall,inputHeight.value=mainConfig.default.pnrmHeightSmall),mainConfig.default.pnrmHeightSmall>mainConfig.default.pnrmHeightLarge&&(mainConfig.default.pnrmHeightLarge=mainConfig.default.pnrmHeightSmall,inputHeightLarge.value=mainConfig.default.pnrmHeightSmall))},inputHeightLarge.onchange=function(){isMainConfigLoaded&&(mainConfig.default.pnrmHeightLarge=Math.round(inputHeightLarge.value),calculateHeightForScreenSizes(),mainPano.resize(),setIsUnsavedChange(),boxMainInterface.classList.contains("large-screen")||spanSizeDesktop.click(),mainConfig.default.pnrmHeightLarge<mainConfig.default.pnrmHeight&&(mainConfig.default.pnrmHeight=mainConfig.default.pnrmHeightLarge,inputHeight.value=mainConfig.default.pnrmHeightLarge),mainConfig.default.pnrmHeightLarge<mainConfig.default.pnrmHeightSmall&&(mainConfig.default.pnrmHeightSmall=mainConfig.default.pnrmHeightLarge,inputHeightSmall.value=mainConfig.default.pnrmHeightLarge))},checkboxFullscreen.onchange=function(){isMainConfigLoaded&&(checkboxFullscreen.checked?(mainConfig.default.pnrmFullscreen=!0,disableResponsiveHeightInputs()):(delete mainConfig.default.pnrmFullscreen,enableResponsiveHeightInputs()),restartAfterDelay())},checkboxThumbnailBar.onchange=function(){isMainConfigLoaded&&(checkboxThumbnailBar.checked?mainConfig.default.pnrmThumbnailBar=!0:(delete mainConfig.default.pnrmThumbnailBar,tBar.hide()),restartAfterDelay())},checkboxCompass.onchange=function(){isMainConfigLoaded&&(mainConfig.default.compass=checkboxCompass.checked,restartAfterDelay())},checkboxAutoload.onchange=function(){isMainConfigLoaded&&(mainConfig.default.autoLoad=checkboxAutoload.checked,restartAfterDelay())},checkboxMousezoom.onchange=function(){isMainConfigLoaded&&(mainConfig.default.mouseZoom=checkboxMousezoom.checked,restartAfterDelay())},inputZoomlevel.onchange=function(){isMainConfigLoaded&&(mainConfig.default.pnrmHfov=Math.round(inputZoomlevel.value),calculateHfovFromPnrmHfov(),restartAfterDelay())},inputAutorotateSpeed.onchange=inputAutorotateSpeedChanged,inputAutorotateStopAfter.onchange=inputAutorotateStopAfterChanged,checkboxAutorotateOnlyFirstScene.onchange=function(){inputAutorotateSpeedChanged(),inputAutorotateStopAfterChanged()},inputSmoothDuration.onchange=function(){isMainConfigLoaded&&(Number(inputSmoothDuration.value)?mainConfig.default.sceneFadeDuration=1e3*Number(inputSmoothDuration.value):delete mainConfig.default.sceneFadeDuration,restartAfterDelay())},inputFontsize.onchange=radioFontsizeAuto.onchange=radioFontsizeFixed.onchange=function(){radioFontsizeAuto.checked||!Number(inputFontsize.value)?(delete mainConfig.default.pnrmFontSize,mainInterface.style.removeProperty("font-size")):(mainConfig.default.pnrmFontSize=Number(inputFontsize.value),mainInterface.style.fontSize=Number(inputFontsize.value)+"px"),restartAfterDelay()},radioFontfamilyDefault.onchange=radioFontfamilyInherit.onchange=function(){radioFontfamilyDefault.checked?(delete mainConfig.default.pnrmFontFamily,mainInterface.style.removeProperty("font-family")):(mainConfig.default.pnrmFontFamily="inherit",mainInterface.style.fontFamily="inherit"),restartAfterDelay()},checkboxAudio.onchange=function(){checkboxAudio.checked?boxAudioOptionsOnOff(!0):boxAudioOptionsOnOff(!1),handleAudioChange()},radioAudioStartClick.onchange=radioAudioStartInteraction.onchange=function(){handleAudioChange()},btnAudioSelectFile.onclick=function(e){e.preventDefault(),(frameSelectAudio=wp.media({title:"Select/Upload Audio File",button:{text:"Select"},library:{type:["audio"]},multiple:!1})).on("select",(function(){var attachment=frameSelectAudio.state().get("selection").first().toJSON();spanAudioFileName.textContent=attachment.filename,audioFileUrl=attachment.url,handleAudioChange()})),frameSelectAudio.open()};var auxInterfaceBox=document.querySelector(".pnrm-editor .box-aux-interface"),auxInterface=document.querySelector(".pnrm-editor #pnrm-aux-interface"),auxInterfaceCloseBtn=document.querySelector(".pnrm-editor .box-aux-interface .close-icon"),inputAuxX=document.querySelector(".pnrm-editor .box-aux-interface #input-aux-x"),inputAuxY=document.querySelector(".pnrm-editor .box-aux-interface #input-aux-y"),auxPano;return auxInterfaceCloseBtn.onclick=setAndCloseAuxInterface,output.printMainConfig=function(){console.log(mainConfig)},output}function hideAllModals(){hideRemoveImageModal(),hideModalTopRightClick(),hideModalInsertUrl(),hideModalEditUrl(),hideModalSceneTitle(),hideModalBanner()}function loadConfig(){mainConfig={},isMainConfigLoaded=!1;var postId=currentTourId;inputShortcode.value='[panorom id="'+postId+'"]',showModalAjaxLoading();var dataToSend={action:"get_tour",post_id:postId};jQuery.post(ajaxurl,dataToSend).done((function(response){if(response.error)showModalAjaxOtherError(response.error);else{closeModalAjax();var receivedConfig=JSON.parse(response.data);mainConfig=receivedConfig,addHotSpotRightClickHandlerFunc(),correctHttpProtocol(),removeDefaultSceneHfov(),removeScenePreviewImage(),isMainConfigLoaded=!0,initDefaultOptions(),initPreview(),initModalIcon(),initModalLogo(),applyConfigToMainLogo(),calculateHfovFromPnrmHfov(),calculateHeightForScreenSizes(),initMainPano(),initBanner()}})).fail((function(xhr,status,error){showModalAjaxServerError()}))}function saveConfig(){var postId=currentTourId;delete mainConfig.default.minHfov,delete mainConfig.default.maxHfov,delete mainConfig.default.pnrmHeightMedium;var mainConfigJson=JSON.stringify(mainConfig);showModalAjaxSaving(),deactivateSaveBtn();var data={action:"update_tour",post_id:postId,config:mainConfigJson},allInputsNonce=divNonce.querySelectorAll("input");allInputsNonce&&allInputsNonce.forEach((function(inputNonce){var propName=inputNonce.name,propValue=inputNonce.value;data[propName]=propValue})),jQuery.post(ajaxurl,data).done((function(response){response.error?showModalAjaxOtherError(response.error):(showModalAjaxSaveSuccess(),clearIsUnsavedChange(),setTimeout((function(){closeModalAjax(),activateSaveBtn()}),2e3))})).fail((function(xhr,status,error){showModalAjaxServerError(),activateSaveBtn()}))}function correctHttpProtocol(){for(let key in mainConfig.scenes){var scene=mainConfig.scenes[key],panoramaNoHttp=scene.panorama.replace(/^https?:\/\//,"");scene.panorama=window.location.protocol+"//"+panoramaNoHttp;var thumbnailNoHttp=scene.thumbnail.replace(/^https?:\/\//,"");scene.thumbnail=window.location.protocol+"//"+thumbnailNoHttp}}function removeDefaultSceneHfov(){for(let key in mainConfig.scenes){var scene;delete mainConfig.scenes[key].hfov}}function removeScenePreviewImage(){for(let key in mainConfig.scenes){var scene=mainConfig.scenes[key];delete scene.preview,delete scene.pnrmLoadPreview}}function addHotSpotRightClickHandlerFunc(){for(let key in mainConfig.scenes){var scene=mainConfig.scenes[key];if(void 0!==scene.hotSpots)for(var i=0;i<scene.hotSpots.length;i++)"scene"===scene.hotSpots[i].type&&(scene.hotSpots[i].rightClickHandlerFunc=hotspotRightClickHandler),"info"===scene.hotSpots[i].type&&(scene.hotSpots[i].rightClickHandlerFunc=infospotRightClickHandler,scene.hotSpots[i].clickHandlerFunc=infospotClickHandler)}}function deactivateSaveBtn(){btnSave.disabled=!0}function activateSaveBtn(){btnSave.disabled=!1}function setIsUnsavedChange(){isUnsavedChange=!0,btnSave.classList.add("is-unsaved-change")}function clearIsUnsavedChange(){isUnsavedChange=!1,btnSave.classList.remove("is-unsaved-change")}function setModalAjaxToDefault(){modalBackground.classList.remove("show"),modalAjax.classList.remove("loading-state"),modalAjax.classList.remove("saving-state"),modalAjax.classList.remove("success-state"),modalAjax.classList.remove("error-state"),modalAjax.classList.remove("show")}function closeModalAjax(){setModalAjaxToDefault()}function showModalAjaxLoading(){setModalAjaxToDefault(),modalBackground.classList.add("show"),modalAjax.classList.add("loading-state"),modalAjax.classList.add("show")}function showModalAjaxSaving(){setModalAjaxToDefault(),modalBackground.classList.add("show"),modalAjax.classList.add("saving-state"),modalAjax.classList.add("show")}function showModalAjaxServerError(){setModalAjaxToDefault(),modalBackground.classList.add("show"),modalAjax.classList.add("error-state"),modalAjax.classList.add("show")}function showModalAjaxOtherError(msg){setModalAjaxToDefault(),modalBackground.classList.add("show"),modalAjaxErrorMsg.textContent=msg,modalAjax.classList.add("error-state"),modalAjax.classList.add("show")}function showModalAjaxSaveSuccess(){setModalAjaxToDefault(),modalBackground.classList.add("show"),modalAjax.classList.add("success-state"),modalAjax.classList.add("show")}function resetMainPano(){mainPano&&mainPano.destroy()}function initMainPano(){(mainPano=pannellumMod.viewer("pnrm-main-interface",mainConfig)).on("scenechange",(function(sceneId){handlePreviewSceneChange(sceneId)})),mainConfig.default.pnrmThumbnailBar&&tBar.draw(mainConfig,mainPano)}function showSceneOnMainDiv(sceneId){mainPano.loadScene(sceneId),mainConfig.default.pnrmThumbnailBar&&tBar.draw(mainConfig,mainPano)}function removeSceneFromMainPano(sceneId){delete mainConfig.scenes[sceneId],resetMainPano(),initMainPano()}function hideModalTopRightClick(){modalTopRightClick.classList.remove("show"),modalTopRightClick.style.left="0",modalTopRightClick.style.top="0"}function showModalTopRightClick(pointerX,pointerY,clickPitch,clickYaw){modalTopRightClick.dataset.clickPitch=clickPitch,modalTopRightClick.dataset.clickYaw=clickYaw,modalTopRightClick.style.left=pointerX+"px",modalTopRightClick.style.top=pointerY+"px",modalTopRightClick.classList.add("show")}function handleSetSceneDefault(){var sceneId=mainPano.getScene(),yaw=Math.round(mainPano.getYaw()),pitch=Math.round(mainPano.getPitch());mainConfig.scenes[sceneId].yaw=yaw,mainConfig.scenes[sceneId].pitch=pitch}function handleAddHotspot(type){var clickPitch=modalTopRightClick.dataset.clickPitch,clickYaw=modalTopRightClick.dataset.clickYaw,sceneId=mainPano.getScene(),scene=mainConfig.scenes[sceneId],hsLastId=0;scene.hotSpots&&scene.hotSpots.forEach((function(hotspot){var currentHsId=Number(hotspot.id);NaN!=currentHsId&&currentHsId>hsLastId&&(hsLastId=currentHsId)})),hsLastId++;var hs={id:String(hsLastId),pitch:clickPitch,yaw:clickYaw};"scene"==type&&(hs.type="scene",hs.text="",hs.sceneId=mainConfig.default.firstScene,hs.rightClickHandlerArgs={hsId:String(hsLastId)},hs.rightClickHandlerFunc=hotspotRightClickHandler),"info"==type&&(hs.type="info",hs.text="",hs.rightClickHandlerArgs={hsId:String(hsLastId)},hs.rightClickHandlerFunc=infospotRightClickHandler,hs.clickHandlerArgs={hsId:String(hsLastId)},hs.clickHandlerFunc=infospotClickHandler),mainPano.addHotSpot(hs)}function hideModalBanner(){modalBanner.classList.remove("show"),modalBanner.style.left="0",modalBanner.style.top="0",removeAllBannerRightClickedClasses()}function showModalBanner(pointerX,pointerY,imgId){console.log(imgId),modalBanner.dataset.imgId=imgId,modalBanner.style.left=pointerX+"px",modalBanner.style.top=pointerY+"px",modalBanner.classList.add("show")}function handleSetAsFirstScene(sceneId){let tmpAutoRotate,tmpAutoRotateStopDelay;mainConfig.default.firstScene&&"0"!==mainConfig.default.firstScene&&(tmpAutoRotate=mainConfig.scenes[mainConfig.default.firstScene].autoRotate,delete mainConfig.scenes[mainConfig.default.firstScene].autoRotate,tmpAutoRotateStopDelay=mainConfig.scenes[mainConfig.default.firstScene].autoRotateStopDelay,delete mainConfig.scenes[mainConfig.default.firstScene].autoRotateStopDelay),mainConfig.default.firstScene=sceneId,tmpAutoRotate&&mainConfig.default.firstScene&&"0"!==mainConfig.default.firstScene&&(mainConfig.scenes[mainConfig.default.firstScene].autoRotate=tmpAutoRotate),tmpAutoRotateStopDelay&&mainConfig.default.firstScene&&"0"!==mainConfig.default.firstScene&&(mainConfig.scenes[mainConfig.default.firstScene].autoRotateStopDelay=tmpAutoRotateStopDelay),bannerSetFirstScene(sceneId)}function handleEditUrl(sceneId){showEditUrlModal(sceneId)}function handleChangeImage(sceneId){var selectedScene=mainConfig.scenes[sceneId];selectedScene&&((frameMediaChangeImage=wp.media({title:"Select/Upload Your Equirectangular Image",button:{text:"Select"},library:{type:["image"]},multiple:!1})).on("select",(function(){var attachment=frameMediaChangeImage.state().get("selection").first().toJSON(),panoramaUrl=void 0!==attachment.originalImageURL?attachment.originalImageURL:attachment.url,panoramaUrlNoHttp=panoramaUrl.replace(/^https?:\/\//,"");selectedScene.panorama=window.location.protocol+"//"+panoramaUrlNoHttp;var thumbnailUrl=attachment.url;void 0!==attachment.sizes&&void 0!==attachment.sizes.medium&&(thumbnailUrl=attachment.sizes.medium.url);var thumbnailUrlNoHttp=thumbnailUrl.replace(/^https?:\/\//,"");selectedScene.thumbnail=window.location.protocol+"//"+thumbnailUrlNoHttp,bannerUpdateThumbnail(sceneId,panoramaUrl,selectedScene.thumbnail),showSceneOnMainDiv(sceneId),setIsUnsavedChange()})),frameMediaChangeImage.open())}function infospotClickHandler(e,clickArgs){var hsId=clickArgs.hsId;"A"!==e.target.nodeName&&null!=hsId&&(hideAllModals(),hideModalInfoSpot(),showInfoOverlay(hsId))}function showInfoOverlay(hsId){var scene,hs=mainConfig.scenes[mainPano.getScene()].hotSpots.find((function(hotspot){return hotspot.id==hsId}));if(void 0!==hs&&"info"===hs.type&&hs.infoImage){var pInfoTitle=document.querySelector(".pnrm-editor .info-overlay .info-title"),imgInfoImage=document.querySelector(".pnrm-editor .info-overlay .info-image");if(pInfoTitle.textContent=hs.text,hs.infoURL){pInfoTitle.innerHTML="";var aInfo=document.createElement("a");aInfo.href=sanitizeURL(hs.infoURL,!0),aInfo.target="_blank";var linkIcon='<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link" style="vertical-align: middle;"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg>',infoText=void 0!==hs.text?String(hs.text):"";aInfo.innerHTML=infoText+" "+linkIcon,pInfoTitle.appendChild(aInfo)}imgInfoImage.src=sanitizeURL(hs.infoImage,!0),infoOverlay.classList.add("show")}}function hideModalInsertUrl(){modalInsertUrlInputUrl.value="",modalInsertUrl.classList.remove("show")}function hideModalEditUrl(){modalEditUrl.dataset.imgId="0",modalEditUrlInputUrl.value="",modalEditUrl.classList.remove("show")}function showEditUrlModal(sceneId){var selectedScene=mainConfig.scenes[sceneId];selectedScene&&(modalEditUrlInputUrl.value=selectedScene.panorama,modalEditUrl.dataset.imgId=sceneId,modalEditUrl.classList.add("show"))}function resetPreview(){modalPreviewInputImage.value="",previewSmallBox.removeAttribute("style"),modalPreviewBoxResultImage.removeAttribute("style")}function initPreview(){mainConfig.default.preview&&(modalPreviewInputImage.value=mainConfig.default.preview,previewSmallBox.style.backgroundImage="url("+mainConfig.default.preview+")",modalPreviewBoxResultImage.style.backgroundImage="url("+mainConfig.default.preview+")")}function handlePreviewSceneChange(sceneId){modalPreview.classList.remove("show");var scene=mainConfig.scenes[sceneId];if(scene&&scene.previewTitle){var infoDisplay=document.querySelector(".pnrm-pnlm-panorama-info"),titleBox=document.querySelector(".pnrm-pnlm-title-box");infoDisplay&&titleBox&&(titleBox.textContent=scene.previewTitle,infoDisplay.style.display="inline")}}function handlePreviewInputImageChange(){""!==modalPreviewInputImage.value?modalPreviewBoxResultImage.style.backgroundImage="url("+modalPreviewInputImage.value+")":modalPreviewBoxResultImage.removeAttribute("style")}function resetModalLogo(){modalLogo.classList.remove("show"),modalLogoInputImage.value="",modalLogoRadioSizeAuto.checked=!0,modalLogoInputSize.value=30,modalLogoInputSize.disabled=!0,modalLogoInputLink.value="",modalLogoCustomLogo.style.display="initial",modalLogoCustomLogoImg.style.width="initial",modalLogoCustomLogoImg.src=""}function initModalLogo(){modalLogoInputImage.value=mainConfig.default.pnrmLogoUrl?mainConfig.default.pnrmLogoUrl:"",modalLogoRadioSizeAuto.checked=!mainConfig.default.pnrmLogoSizeFixed,modalLogoRadioSizeFixed.checked=!!mainConfig.default.pnrmLogoSizeFixed,modalLogoInputSize.disabled=!mainConfig.default.pnrmLogoSizeFixed,modalLogoInputSize.value=mainConfig.default.pnrmLogoSizeFixed?mainConfig.default.pnrmLogoSizeFixed:30,modalLogoInputLink.value=mainConfig.default.pnrmLogoLink?mainConfig.default.pnrmLogoLink:"",modalLogoCustomLogo.style.display=mainConfig.default.pnrmLogoHide?"none":"initial",modalLogoCustomLogoImg.style.width=mainConfig.default.pnrmLogoSizeFixed?mainConfig.default.pnrmLogoSizeFixed+"px":"initial",modalLogoCustomLogoImg.src=mainConfig.default.pnrmLogoUrl?mainConfig.default.pnrmLogoUrl:""}function applyConfigToMainLogo(){var mainLogo=boxMainInterface.querySelector(".custom-logo"),mainLogoImg=boxMainInterface.querySelector(".custom-logo img");mainConfig.default.pnrmLogoUrl?(mainLogoImg.src=mainConfig.default.pnrmLogoUrl,mainLogo.classList.add("show")):(mainLogoImg.src="",mainLogo.classList.remove("show")),mainConfig.default.pnrmLogoSizeFixed?mainLogoImg.style.width=mainConfig.default.pnrmLogoSizeFixed+"px":mainLogoImg.style.width="initial",mainConfig.default.pnrmLogoLink?mainLogo.href=mainConfig.default.pnrmLogoLink:mainLogo.href=""}function hideModalIcon(){modalIcon.classList.remove("show")}function resetModalIcon(){hideModalIcon(),modalIconInputColor.value="#222222",modalIconInputSize.value=15,modalIconInputBackgroundColor.value="#ffffff",modalIconInputBackgroundOpacity.value=.8,modalIconInputBackgroundSize.value=30,modalIconSwitchTooltip.checked=!1,modalIconPreviewIcons.forEach((function(previewIcon){previewIcon.style.width="30px",previewIcon.style.height="30px",previewIcon.style.fontSize="15px",previewIcon.style.color="#222222";var hex,opacity=.8,rgbObj=hexToRgb("#ffffff");if(rgbObj){var rgba="rgba("+rgbObj.r+","+rgbObj.g+","+rgbObj.b+",0.8)";previewIcon.style.backgroundColor=rgba}}))}function initModalIcon(){modalIconInputColor.value=mainConfig.default.pnrmIconColor?mainConfig.default.pnrmIconColor:"#222222",modalIconInputSize.value=mainConfig.default.pnrmIconSize?mainConfig.default.pnrmIconSize:15,modalIconInputBackgroundColor.value=mainConfig.default.pnrmIconBackgroundColor?mainConfig.default.pnrmIconBackgroundColor:"#ffffff",modalIconInputBackgroundOpacity.value=mainConfig.default.pnrmIconBackgroundOpacity?mainConfig.default.pnrmIconBackgroundOpacity:.8,modalIconInputBackgroundSize.value=mainConfig.default.pnrmIconBackgroundSize?mainConfig.default.pnrmIconBackgroundSize:30,modalIconSwitchTooltip.checked=!!mainConfig.default.pnrmIconToTooltip,modalIconPreviewIcons.forEach((function(previewIcon){addIconStyleToEl(previewIcon)}))}function addIconStyleToEl(iconEl){iconEl.style.width=(mainConfig.default.pnrmIconBackgroundSize?mainConfig.default.pnrmIconBackgroundSize:30)+"px",iconEl.style.height=(mainConfig.default.pnrmIconBackgroundSize?mainConfig.default.pnrmIconBackgroundSize:30)+"px",iconEl.style.fontSize=(mainConfig.default.pnrmIconSize?mainConfig.default.pnrmIconSize:15)+"px",iconEl.style.color=mainConfig.default.pnrmIconColor?mainConfig.default.pnrmIconColor:"#222222";var hex=mainConfig.default.pnrmIconBackgroundColor?mainConfig.default.pnrmIconBackgroundColor:"#ffffff",opacity=mainConfig.default.pnrmIconBackgroundOpacity?mainConfig.default.pnrmIconBackgroundOpacity:.8,rgbObj=hexToRgb(hex);if(rgbObj){var rgba="rgba("+rgbObj.r+","+rgbObj.g+","+rgbObj.b+","+opacity+")";iconEl.style.backgroundColor=rgba}}function hexToRgb(hex){var result=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);return result?{r:parseInt(result[1],16),g:parseInt(result[2],16),b:parseInt(result[3],16)}:null}function getIconBackgroundRGBA(){var hex=mainConfig.default.pnrmIconBackgroundColor?mainConfig.default.pnrmIconBackgroundColor:"#ffffff",opacity=mainConfig.default.pnrmIconBackgroundOpacity?mainConfig.default.pnrmIconBackgroundOpacity:.8,rgbObj=hexToRgb(hex),rgba;return rgbObj?"rgba("+rgbObj.r+","+rgbObj.g+","+rgbObj.b+","+opacity+")":null}function hideModalPicker(){modalPicker.classList.remove("show")}function resetModalPicker(){hideModalPicker(),modalPickerInputSearch.value="",modalPickerDivSearchResults.innerHTML="",modalPickerIconPreview.className="icon-preview fa-solid",iconName=null}function openModalPicker(pointerX,pointerY,openFor){modalPicker.classList.contains("show")||(modalPickerIsOpenFor=openFor,modalPicker.style.left=pointerX+"px",modalPicker.style.top=pointerY-modalPicker.getBoundingClientRect().height+"px",addIconStyleToEl(modalPickerIconPreview),modalPicker.classList.add("show"))}function handleInputIconSearchChange(){var searchWord=modalPickerInputSearch.value,searchCount=1,maxCount=40,foundIcons=[];searchWord=searchWord.replace(" ","-");for(let key in iconTermsModalPicker){if(searchCount>40)break;key.includes(searchWord)&&-1===foundIcons.indexOf(key)&&(foundIcons.push(key),searchCount++),iconTermsModalPicker[key].forEach((function(term){term.includes(searchWord)&&-1===foundIcons.indexOf(key)&&(foundIcons.push(key),searchCount++)}))}populateFoundIcons(foundIcons)}function populateFoundIcons(foundIcons){modalPickerDivSearchResults.innerHTML="",foundIcons.forEach((function(eachIconName){var iconElBox=document.createElement("div");iconElBox.className="icon-box";var iconEl=document.createElement("span");iconEl.className="each-icon fa-solid fa-"+eachIconName,iconElBox.appendChild(iconEl),modalPickerDivSearchResults.appendChild(iconElBox)}))}function updatePreviewIconWithSelected(){iconName&&(modalPickerIconPreview.className="icon-preview fa-solid "+iconName)}function showModalMaxHotspot(){modalMaxHotspot.classList.add("show")}function showModalMaxInfospot(){modalMaxInfospot.classList.add("show")}function isMaxHotspotReached(){if(isActivated)return!1;var count=1;for(let key in mainConfig.scenes){var scene=mainConfig.scenes[key];if(void 0!==scene.hotSpots)for(var i=0;i<scene.hotSpots.length;i++)if("scene"===scene.hotSpots[i].type&&++count>10)return showModalMaxHotspot(),!0}return!1}function isMaxInfospotReached(){if(isActivated)return!1;var count=1;for(let key in mainConfig.scenes){var scene=mainConfig.scenes[key];if(void 0!==scene.hotSpots)for(var i=0;i<scene.hotSpots.length;i++)if("info"===scene.hotSpots[i].type&&++count>10)return showModalMaxInfospot(),!0}return!1}function hideModalSceneTitle(){modalSceneTitleInputTitle.value="",modalSceneTitle.classList.remove("show")}function showModalSceneTitle(){var scene=mainConfig.scenes[mainPano.getScene()];scene.previewTitle&&(modalSceneTitleInputTitle.value=scene.previewTitle),modalSceneTitle.classList.add("show")}function calculateHeightForScreenSizes(){var widthOfDiv=boxMainInterface.getBoundingClientRect().width;widthOfDiv<600&&void 0!==mainConfig.default.pnrmHeightSmall?mainInterface.style.height=Number(mainConfig.default.pnrmHeightSmall)+"px":widthOfDiv>1440&&void 0!==mainConfig.default.pnrmHeightLarge?mainInterface.style.height=Number(mainConfig.default.pnrmHeightLarge)+"px":void 0!==mainConfig.default.pnrmHeight&&(mainInterface.style.height=Number(mainConfig.default.pnrmHeight)+"px")}function hideModalInfoSpot(){modalInfoSpot.classList.remove("show"),modalInfoSpot.style.left="0",modalInfoSpot.style.top="0",hideModalPicker()}function infospotRightClickHandler(e,rightClickArgs){var hsId=rightClickArgs.hsId,pointerX,pointerY;(e.preventDefault(),null!=hsId)&&(hideAllModals(),showModalInfoSpotRightClick(e.pageX-pnrmEditorDiv.getBoundingClientRect().left,e.pageY-(pnrmEditorDiv.getBoundingClientRect().top+window.scrollY),hsId))}function updateInfoSpotIcon(iconName,iconAnime=null){modalInfoSpotIconDefault.classList.remove("show"),modalInfoSpotIconCustom.className="icon-custom fa-solid "+iconName,modalInfoSpotIconCustom.dataset.iconName=iconName,addIconStyleToEl(modalInfoSpotIconCustom),modalInfoSpotIconCustom.classList.add("show"),iconAnime?modalInfoSpotIconCustom.dataset.iconAnimation=iconAnime:modalInfoSpotIconCustom.removeAttribute("data-icon-animation")}function showModalInfoSpotRightClick(pointerX,pointerY,hsId){modalInfoSpot.dataset.hsId=hsId;var scene,hs=mainConfig.scenes[mainPano.getScene()].hotSpots.find((function(hotspot){return hotspot.id==hsId}));void 0!==hs&&"info"===hs.type&&(modalInfoSpotTextInput.value=hs.text,void 0===hs.infoWidth?(modalInfoSpotRadioAuto.checked=!0,modalInfoSpotInputWidth.disabled=!0):(modalInfoSpotRadioFixed.checked=!0,modalInfoSpotInputWidth.disabled=!1,modalInfoSpotInputWidth.value=hs.infoWidth),void 0===hs.infoImage?modalInfoSpotInputImage.value="":modalInfoSpotInputImage.value=hs.infoImage,void 0===hs.infoVideo?(modalInfoSpotCheckboxAllowVideo.checked=!1,modalInfoSpotInputVideo.value="",modalInfoSpotDivVideoRow2.classList.remove("show"),modalInfoSpotDivVideoRow3.classList.remove("show")):(modalInfoSpotCheckboxAllowVideo.checked=!0,modalInfoSpotInputVideo.value=hs.infoVideo,modalInfoSpotDivVideoRow2.classList.add("show"),modalInfoSpotDivVideoRow3.classList.add("show")),void 0===hs.infoVideoAutoplay?modalInfoSpotCheckboxAutoplay.checked=!1:modalInfoSpotCheckboxAutoplay.checked=!0,void 0===hs.infoVideoLoop?modalInfoSpotCheckboxLoop.checked=!1:modalInfoSpotCheckboxLoop.checked=!0,void 0===hs.infoURL?(modalInfoSpotCheckboxAllowLink.checked=!1,modalInfoSpotInputLink.value="",modalInfoSpotDivLink.classList.remove("show")):(modalInfoSpotCheckboxAllowLink.checked=!0,modalInfoSpotInputLink.value=hs.infoURL,modalInfoSpotDivLink.classList.add("show")),hs.cssClass&&hs.cssClass.includes("pnrm-hotspot-show-always")?modalInfoSpotRadioAlways.checked=!0:modalInfoSpotRadioHover.checked=!0,hs.pnrmIconName?updateInfoSpotIcon(hs.pnrmIconName,hs.pnrmIconAnimation):(modalInfoSpotIconCustom.classList.remove("show"),modalInfoSpotIconDefault.classList.add("show"),modalInfoSpotIconCustom.removeAttribute("data-icon-name"),modalInfoSpotIconCustom.removeAttribute("data-icon-animation")),modalInfoSpotRemoveCheckbox.checked=!1,modalInfoSpot.style.left=pointerX+"px",modalInfoSpot.style.top=pointerY+"px",modalInfoSpot.classList.add("show"))}function hideModalHotSpot(){modalHotSpot.classList.remove("show"),modalHotSpot.style.left="0",modalHotSpot.style.top="0",hideModalPicker(),hideAuxInterface()}function removeHotspotsPointingToScene(removedSceneId){for(let key in mainConfig.scenes){var scene=mainConfig.scenes[key];if(void 0!==scene.hotSpots){var newHotSpots=[];scene.hotSpots.forEach((function(hotspot){hotspot.sceneId!==removedSceneId&&newHotSpots.push(hotspot)})),scene.hotSpots=newHotSpots}}}function hotspotRightClickHandler(e,rightClickArgs){var hsId=rightClickArgs.hsId,pointerX,pointerY;(e.preventDefault(),null!=hsId)&&(hideAllModals(),showModalHotSpotRightClick(e.pageX-pnrmEditorDiv.getBoundingClientRect().left,e.pageY-(pnrmEditorDiv.getBoundingClientRect().top+window.scrollY),hsId))}function updateHotSpotIcon(iconName,iconAnime){modalHotSpotIconDefault.classList.remove("show"),modalHotSpotIconCustom.className="icon-custom fa-solid "+iconName,modalHotSpotIconCustom.dataset.iconName=iconName,addIconStyleToEl(modalHotSpotIconCustom),modalHotSpotIconCustom.classList.add("show"),iconAnime?modalHotSpotIconCustom.dataset.iconAnimation=iconAnime:modalHotSpotIconCustom.removeAttribute("data-icon-animation")}function showModalHotSpotRightClick(pointerX,pointerY,hsId){modalHotSpot.dataset.hsId=hsId;var scene,hs=mainConfig.scenes[mainPano.getScene()].hotSpots.find((function(hotspot){return hotspot.id==hsId})),sceneIdArray;void 0!==hs&&"scene"===hs.type&&(modalHotSpotSceneSelect.innerHTML="",Object.keys(mainConfig.scenes).forEach((function(sceneId){var option=document.createElement("option"),panoramaText=mainConfig.scenes[sceneId].panorama,filename=panoramaText?panoramaText.substring(panoramaText.lastIndexOf("/")+1,panoramaText.length):"";option.value=sceneId,option.innerText=sceneId+" ("+filename+")",modalHotSpotSceneSelect.appendChild(option)})),modalHotSpotSceneSelect.value=hs.sceneId,modalHotSpotTextInput.value=hs.text,void 0===hs.hotWidth?(modalHotSpotRadioAuto.checked=!0,modalHotSpotInputWidth.disabled=!0):(modalHotSpotRadioFixed.checked=!0,modalHotSpotInputWidth.disabled=!1,modalHotSpotInputWidth.value=hs.hotWidth),hs.cssClass&&hs.cssClass.includes("pnrm-hotspot-show-always")?modalHotSpotRadioAlways.checked=!0:modalHotSpotRadioHover.checked=!0,hs.targetYaw&&"sameAzimuth"===hs.targetYaw?(modalHotSpotRadioTargetAuto.checked=!0,hideAuxInterface(),hideHotSpotRowTargetAdjust()):void 0!==hs.targetYaw?(modalHotSpotTargetInputX.value=hs.targetYaw,modalHotSpotTargetInputY.value=hs.targetPitch,modalHotSpotRadioTargetManual.checked=!0,showHotSpotRowTargetAdjust()):(modalHotSpotTargetInputX.value="",modalHotSpotTargetInputY.value="",modalHotSpotRadioTargetDefault.checked=!0,hideAuxInterface(),hideHotSpotRowTargetAdjust()),hs.pnrmIconName?updateHotSpotIcon(hs.pnrmIconName,hs.pnrmIconAnimation):(modalHotSpotIconCustom.classList.remove("show"),modalHotSpotIconDefault.classList.add("show"),modalHotSpotIconCustom.removeAttribute("data-icon-name"),modalHotSpotIconCustom.removeAttribute("data-icon-animation")),modalHotSpotRemoveCheckbox.checked=!1,modalHotSpot.style.left=pointerX+"px",modalHotSpot.style.top=pointerY+"px",modalHotSpot.classList.add("show"))}function hideHotSpotRowTargetAdjust(){modalHotSpotRowTargetAdjust.classList.remove("show"),modalHotSpotRowTargetMode.classList.remove("no-bottom-border")}function showHotSpotRowTargetAdjust(){modalHotSpotRowTargetAdjust.classList.add("show"),modalHotSpotRowTargetMode.classList.add("no-bottom-border")}function showModalChangeTour(){modalBackground.classList.add("show"),modalChangeTour.classList.add("show")}function hideModalChangeTour(){modalBackground.classList.remove("show"),modalChangeTour.classList.remove("show")}function changeTheTour(){resetDefaultOptions(),resetPreview(),resetModalIcon(),resetModalPicker(),resetModalLogo(),resetMainPano(),clearIsUnsavedChange(),resetBanner(),hideModalInfoSpot(),hideModalHotSpot(),currentTourId=selectTour.value,loadConfig()}function resetBanner(){bannerImageContainer.innerHTML=""}function initBanner(){for(let key in mainConfig.scenes){var sceneId=key,panoramaText=mainConfig.scenes[sceneId].panorama,filename;addImageElementToBanner(sceneId,panoramaText?panoramaText.substring(panoramaText.lastIndexOf("/")+1,panoramaText.length):"")}}function hideRemoveImageModal(){modalRemoveImage.classList.remove("show")}function showRemoveImageModal(event,imgId){var pointerX=event.pageX-pnrmEditorDiv.getBoundingClientRect().left,pointerY=event.pageY-(pnrmEditorDiv.getBoundingClientRect().top+window.scrollY),modalWidth=215;modalRemoveImage.style.left=pointerX-215+"px",modalRemoveImage.style.top=pointerY+"px",modalRemoveImage.style.width="215px",modalRemoveImage.setAttribute("data-img-id",imgId),modalRemoveImage.classList.add("show")}function bannerSetFirstScene(sceneId){var eachImageAll=document.querySelectorAll(".pnrm-editor .banner .each-image");for(let i=0;i<eachImageAll.length;i++)eachImageAll[i].dataset.imgId==sceneId?eachImageAll[i].querySelector(".first-scene-text").classList.add("show"):eachImageAll[i].querySelector(".first-scene-text").classList.remove("show")}function bannerUpdateThumbnail(sceneId,panoramaUrl,thumbnailUrl){var divEachImage=null,eachImageAll=document.querySelectorAll(".pnrm-editor .banner .each-image");for(let i=0;i<eachImageAll.length;i++)if(eachImageAll[i].dataset.imgId==sceneId){divEachImage=eachImageAll[i];break}if(divEachImage){divEachImage.querySelector(".img-content").style="background-image: url("+thumbnailUrl+")";var filename=panoramaUrl.substring(panoramaUrl.lastIndexOf("/")+1,panoramaUrl.length);divEachImage.querySelector(".img-filename").textContent=filename}}function addImageElementToBanner(sceneId,filename){var scene=mainConfig.scenes[sceneId];if(scene){var divEachImage=document.createElement("div");divEachImage.setAttribute("class","each-image"),divEachImage.setAttribute("data-img-id",sceneId);var divImgContent=document.createElement("div");divImgContent.setAttribute("class","img-content");var src=scene.thumbnail;divImgContent.setAttribute("style","background-image: url("+src+")");var tableImgUi=document.createElement("table");tableImgUi.setAttribute("class","img-ui");var tr=document.createElement("tr"),tdId=document.createElement("td");tdId.setAttribute("class","td-id");var spanImgId=document.createElement("span");spanImgId.setAttribute("class","img-id"),spanImgId.textContent=sceneId;var tdMiddle=document.createElement("td");tdMiddle.setAttribute("class","td-middle");var spanFirstSceneText=document.createElement("span");spanFirstSceneText.setAttribute("class","first-scene-text"),spanFirstSceneText.textContent=document.querySelector(".pnrm-editor #first-scene-text-translation").value,sceneId===mainConfig.default.firstScene&&spanFirstSceneText.classList.add("show");var tdDelete=document.createElement("td");tdDelete.setAttribute("class","td-delete");var spanDeleteIcon=document.createElement("span");spanDeleteIcon.setAttribute("class","dashicons dashicons-no-alt icon"),spanDeleteIcon.setAttribute("title","remove image");var pImgFilename=document.createElement("p");pImgFilename.setAttribute("class","img-filename"),pImgFilename.textContent=filename,tdMiddle.appendChild(spanFirstSceneText),tdId.appendChild(spanImgId),tdDelete.appendChild(spanDeleteIcon),tr.appendChild(tdId),tr.appendChild(tdMiddle),tr.appendChild(tdDelete),tableImgUi.appendChild(tr),divEachImage.appendChild(divImgContent),divEachImage.appendChild(tableImgUi),divEachImage.appendChild(pImgFilename),bannerImageContainer.appendChild(divEachImage),spanDeleteIcon.onclick=function(e){e.stopPropagation(),showRemoveImageModal(e,sceneId)},divEachImage.onclick=function(){showSceneOnMainDiv(sceneId)},divEachImage.oncontextmenu=function(e){e.preventDefault();var pointerX=e.pageX-pnrmEditorDiv.getBoundingClientRect().left,pointerY=e.pageY-(pnrmEditorDiv.getBoundingClientRect().top+window.scrollY);removeAllBannerRightClickedClasses(),divEachImage.classList.add("right-clicked"),showModalBanner(pointerX,pointerY,sceneId)},divEachImage.scrollIntoView()}}function removeAllBannerRightClickedClasses(){var allEachImages;document.querySelectorAll(".pnrm-editor .banner .img-container .each-image").forEach((function(eachImage){eachImage.classList.remove("right-clicked")}))}function handleImageDelete(sceneId){var isFirstScene=!1,foundImageEl=null,subSceneId="0",eachImageAll=document.querySelectorAll(".pnrm-editor .banner .each-image");if(eachImageAll){sceneId==mainConfig.default.firstScene&&(isFirstScene=!0);for(let i=0;i<eachImageAll.length;i++)if(eachImageAll[i].dataset.imgId==sceneId){foundImageEl=eachImageAll[i];var subImageEl=null;i>0?subSceneId=(subImageEl=eachImageAll[i-1]).dataset.imgId:eachImageAll.length>1?subSceneId=(subImageEl=eachImageAll[1]).dataset.imgId:(subImageEl=null,subSceneId="0");break}foundImageEl&&(foundImageEl.remove(),removeHotspotsPointingToScene(sceneId),isFirstScene&&handleSetAsFirstScene(subSceneId),showSceneOnMainDiv(subSceneId),removeSceneFromMainPano(sceneId))}}function resetDefaultOptions(){boxMainInterface.classList.remove("small-screen"),boxMainInterface.classList.remove("large-screen"),spanSizeDesktop.classList.remove("selected"),spanSizeLaptop.classList.add("selected"),spanSizeMobile.classList.remove("selected"),inputHeight.value=500,inputHeightSmall.value=400,inputHeightLarge.value=600,checkboxFullscreen.checked=!1,enableResponsiveHeightInputs(),mainInterface.style.height="500px",checkboxThumbnailBar.checked=!1,tBar&&tBar.hide(),radioFontsizeAuto.checked=!0,radioFontfamilyDefault.checked=!0,checkboxCompass.checked=!1,checkboxAutoload.checked=!0,checkboxMousezoom.checked=!1,inputZoomlevel.value=100,inputAutorotateSpeed.value=0,inputAutorotateStopAfter.value=0,checkboxAutorotateOnlyFirstScene.checked=!1,inputSmoothDuration.value=0,inputFontsize.value=14,mainInterface.style.removeProperty("font-size"),checkboxAudio.checked=!1,audioFileUrl=null,spanAudioFileName.textContent="No File Selected.",radioAudioStartInteraction.checked=!0}function initDefaultOptions(){if(inputHeight.value=void 0!==mainConfig.default.pnrmHeight?mainConfig.default.pnrmHeight:500,mainConfig.default.pnrmHeightSmall=mainConfig.default.pnrmHeightSmall||400,inputHeightSmall.value=mainConfig.default.pnrmHeightSmall,mainConfig.default.pnrmHeightLarge=mainConfig.default.pnrmHeightLarge||600,inputHeightLarge.value=mainConfig.default.pnrmHeightLarge,mainInterface.style.height=void 0!==mainConfig.default.pnrmHeight?mainConfig.default.pnrmHeight+"px":"500px",checkboxCompass.checked=mainConfig.default.compass,checkboxAutoload.checked=mainConfig.default.autoLoad,checkboxMousezoom.checked=mainConfig.default.mouseZoom,inputAutorotateSpeed.value=Number(mainConfig.default.autoRotate)?mainConfig.default.autoRotate:0,inputAutorotateSpeed.value=mainConfig.default.firstScene&&"0"!==mainConfig.default.firstScene&&Number(mainConfig.scenes[mainConfig.default.firstScene].autoRotate)?mainConfig.scenes[mainConfig.default.firstScene].autoRotate:inputAutorotateSpeed.value,inputAutorotateStopAfter.value=Number(mainConfig.default.autoRotateStopDelay)?mainConfig.default.autoRotateStopDelay/1e3:0,inputAutorotateStopAfter.value=mainConfig.default.firstScene&&"0"!==mainConfig.default.firstScene&&Number(mainConfig.scenes[mainConfig.default.firstScene].autoRotateStopDelay)?mainConfig.scenes[mainConfig.default.firstScene].autoRotateStopDelay/1e3:inputAutorotateStopAfter.value,checkboxAutorotateOnlyFirstScene.checked=!(!mainConfig.default.firstScene||"0"===mainConfig.default.firstScene||!Number(mainConfig.scenes[mainConfig.default.firstScene].autoRotate)),inputSmoothDuration.value=Number(mainConfig.default.sceneFadeDuration)?mainConfig.default.sceneFadeDuration/1e3:0,void 0!==mainConfig.default.pnrmFontSize&&(inputFontsize.value=mainConfig.default.pnrmFontSize,radioFontsizeFixed.checked=!0,mainInterface.style.fontSize=Number(inputFontsize.value)+"px"),void 0!==mainConfig.default.pnrmFontFamily&&(radioFontfamilyInherit.checked=!0,mainInterface.style.fontFamily="inherit"),void 0===mainConfig.default.pnrmHfov&&(mainConfig.default.pnrmHfov=100),inputZoomlevel.value=Number(mainConfig.default.pnrmHfov),void 0!==mainConfig.default.pnrmAudioFileUrl){checkboxAudio.checked=!0,boxAudioOptions.style.display="block";const parts=(audioFileUrl=mainConfig.default.pnrmAudioFileUrl).split("/");spanAudioFileName.textContent=parts[parts.length-1],boxAudioOptionsOnOff(!0)}else boxAudioOptionsOnOff(!1);void 0!==mainConfig.default.pnrmAudioStartOnClick?radioAudioStartClick.checked=!0:radioAudioStartInteraction.checked=!0,mainConfig.default.pnrmFullscreen?(checkboxFullscreen.checked=!0,disableResponsiveHeightInputs()):(checkboxFullscreen.checked=!1,enableResponsiveHeightInputs()),mainConfig.default.pnrmThumbnailBar?checkboxThumbnailBar.checked=!0:checkboxThumbnailBar.checked=!1}function disableResponsiveHeightInputs(){inputHeight.setAttribute("disabled",""),inputHeightSmall.setAttribute("disabled",""),inputHeightLarge.setAttribute("disabled","")}function enableResponsiveHeightInputs(){inputHeight.removeAttribute("disabled"),inputHeightSmall.removeAttribute("disabled"),inputHeightLarge.removeAttribute("disabled")}function inputAutorotateSpeedChanged(){isMainConfigLoaded&&(Number(inputAutorotateSpeed.value)?checkboxAutorotateOnlyFirstScene.checked?(delete mainConfig.default.autoRotate,mainConfig.scenes[mainConfig.default.firstScene].autoRotate=Number(inputAutorotateSpeed.value)):(delete mainConfig.scenes[mainConfig.default.firstScene].autoRotate,mainConfig.default.autoRotate=Number(inputAutorotateSpeed.value)):(delete mainConfig.default.autoRotate,delete mainConfig.scenes[mainConfig.default.firstScene].autoRotate),restartAfterDelay())}function inputAutorotateStopAfterChanged(){isMainConfigLoaded&&(Number(inputAutorotateStopAfter.value)?checkboxAutorotateOnlyFirstScene.checked?(delete mainConfig.default.autoRotateStopDelay,mainConfig.scenes[mainConfig.default.firstScene].autoRotateStopDelay=1e3*Number(inputAutorotateStopAfter.value)):(delete mainConfig.scenes[mainConfig.default.firstScene].autoRotateStopDelay,mainConfig.default.autoRotateStopDelay=1e3*Number(inputAutorotateStopAfter.value)):(delete mainConfig.default.autoRotateStopDelay,delete mainConfig.scenes[mainConfig.default.firstScene].autoRotateStopDelay),restartAfterDelay())}function boxAudioOptionsOnOff(isOn){boxAudioOptions.style.opacity=isOn?1:.4}function restartAfterDelay(){clearTimeout(timerDelayId),timerDelayId=setTimeout((function(){resetMainPano(),initMainPano(),setIsUnsavedChange()}),1e3)}function calculateHfovFromPnrmHfov(){var widthOfDiv=boxMainInterface.getBoundingClientRect().width;mainConfig.default.hfov=widthOfDiv<600?Number(mainConfig.default.pnrmHfov)-20:widthOfDiv>1440?Number(mainConfig.default.pnrmHfov)+10:Number(mainConfig.default.pnrmHfov)}function calculatePnrmHandleMoveDisplay(){var pnrmHandleMove=boxMainInterface.querySelector(".box-main-interface .pnrm-handle-move"),widthOfDiv=boxMainInterface.getBoundingClientRect().width,heightOfDiv=boxMainInterface.getBoundingClientRect().height;widthOfDiv<600&&heightOfDiv>200?pnrmHandleMove&&pnrmHandleMove.setAttribute("style","display: block;"):pnrmHandleMove&&pnrmHandleMove.setAttribute("style","display: none;")}function handleAudioChange(){checkboxAudio.checked&&audioFileUrl?(mainConfig.default.pnrmAudioFileUrl=audioFileUrl,radioAudioStartClick.checked?mainConfig.default.pnrmAudioStartOnClick="true":delete mainConfig.default.pnrmAudioStartOnClick):(delete mainConfig.default.pnrmAudioFileUrl,delete mainConfig.default.pnrmAudioStartOnClick),setIsUnsavedChange()}function auxInterfaceLoadScene(imagePanorama){(auxPano=pannellumMod.viewer(auxInterface,{type:"equirectangular",panorama:imagePanorama,autoLoad:!0,hfov:50,yaw:Number(inputAuxX.value),pitch:Number(inputAuxY.value)})).on("animatefinished",(function(obj){inputAuxX.value=obj.yaw.toFixed(),inputAuxY.value=obj.pitch.toFixed()}))}function hideAuxInterface(){auxInterfaceBox.classList.remove("show")}function showAuxInterface(pointerX,pointerY,imagePanorama,menuInputValueX,menuInputValueY){auxInterfaceBox.classList.contains("show")||(auxInterfaceBox.style.left=pointerX+"px",auxInterfaceBox.style.top=pointerY-auxInterfaceBox.offsetHeight+"px",inputAuxX.value=menuInputValueX,inputAuxY.value=menuInputValueY,auxInterfaceBox.classList.add("show"),auxInterfaceLoadScene(imagePanorama))}function auxInterfacePushXYtoMenu(){modalHotSpotTargetInputX.value=inputAuxX.value,modalHotSpotTargetInputY.value=inputAuxY.value}function setAndCloseAuxInterface(){auxInterfaceBox.classList.contains("show")&&(auxPano&&auxPano.destroy(),auxInterfacePushXYtoMenu(),hideAuxInterface())}function sanitizeURL(url,href){try{var decoded_url=decodeURIComponent(unescape(url)).replace(/[^\w:]/g,"").toLowerCase()}catch(e){return"about:blank"}return 0===decoded_url.indexOf("javascript:")||0===decoded_url.indexOf("vbscript:")?(console.log("Script URL removed."),"about:blank"):href&&0===decoded_url.indexOf("data:")?(console.log("Data URI removed from link."),"about:blank"):url}function unescape(html){return html.replace(/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/gi,(function(_,n){return"colon"===(n=n.toLowerCase())?":":"#"===n.charAt(0)?"x"===n.charAt(1)?String.fromCharCode(parseInt(n.substring(2),16)):String.fromCharCode(+n.substring(1)):""}))}function sanitizeURLForCss(url){return sanitizeURL(url).replace(/"/g,"%22").replace(/'/g,"%27")}}(window,document);